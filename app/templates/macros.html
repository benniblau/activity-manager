{# Reusable Jinja2 macros for templates #}

{# Sport type to Font Awesome icon mapping #}
{% macro sport_icon(sport_type) %}
{%- set sport_lower = sport_type|lower|replace(' ', '')|replace('-', '') -%}
{%- if sport_lower in ['run', 'virtualrun', 'trailrun'] -%}
<i class="fa-solid fa-person-running"></i>
{%- elif sport_lower in ['ride', 'virtualride', 'mountainbikeride', 'gravelride', 'ebikeride'] -%}
<i class="fa-solid fa-bicycle"></i>
{%- elif sport_lower == 'swim' -%}
<i class="fa-solid fa-person-swimming"></i>
{%- elif sport_lower == 'walk' -%}
<i class="fa-solid fa-person-walking"></i>
{%- elif sport_lower == 'hike' -%}
<i class="fa-solid fa-person-hiking"></i>
{%- elif sport_lower == 'weighttraining' -%}
<i class="fa-solid fa-dumbbell"></i>
{%- elif sport_lower == 'workout' -%}
<i class="fa-solid fa-heart-pulse"></i>
{%- elif sport_lower == 'yoga' -%}
<i class="fa-solid fa-spa"></i>
{%- elif sport_lower == 'crossfit' -%}
<i class="fa-solid fa-bolt"></i>
{%- elif sport_lower in ['rowing', 'rowindoor'] -%}
<i class="fa-solid fa-water"></i>
{%- elif sport_lower in ['elliptical', 'stairstepper'] -%}
<i class="fa-solid fa-stairs"></i>
{%- elif sport_lower == 'golf' -%}
<i class="fa-solid fa-golf-ball-tee"></i>
{%- elif sport_lower in ['tennis', 'pickleball'] -%}
<i class="fa-solid fa-table-tennis-paddle-ball"></i>
{%- elif sport_lower in ['alpineski', 'nordicski', 'backcountryski'] -%}
<i class="fa-solid fa-person-skiing"></i>
{%- elif sport_lower == 'snowboard' -%}
<i class="fa-solid fa-person-snowboarding"></i>
{%- elif sport_lower == 'iceskate' -%}
<i class="fa-solid fa-person-skating"></i>
{%- elif sport_lower == 'skateboard' -%}
<i class="fa-solid fa-person-skating"></i>
{%- elif sport_lower == 'surfing' -%}
<i class="fa-solid fa-water"></i>
{%- elif sport_lower == 'rockclimbing' -%}
<i class="fa-solid fa-mountain"></i>
{%- elif sport_lower == 'soccer' -%}
<i class="fa-solid fa-futbol"></i>
{%- elif sport_lower == 'basketball' -%}
<i class="fa-solid fa-basketball"></i>
{%- else -%}
<i class="fa-solid fa-person"></i>
{%- endif -%}
{% endmacro %}

{# Sport badge with icon - combines icon and text in a badge #}
{# Supports optional extended_type_name and extended_color_class for custom activity types #}
{% macro sport_badge(sport_type, extended_type_name=None, extended_color_class=None) %}
{%- if extended_type_name -%}
<span class="activity-badge badge {{ extended_color_class or ('badge-sport-' + sport_type|lower|replace(' ', '')|replace('-', '')) }}">{{ sport_icon(sport_type) }} {{ extended_type_name }}</span>
{%- else -%}
<span class="activity-badge badge badge-sport-{{ sport_type|lower|replace(' ', '')|replace('-', '') }}">{{ sport_icon(sport_type) }} {{ sport_type }}</span>
{%- endif -%}
{% endmacro %}

{# Pain level to Font Awesome face icon with color gradient (green to red) #}
{# Uses CSS classes from style.css for colors - single source of truth #}
{% macro pain_icon(level, size='md') %}
{%- if level is not none and level is defined -%}
{%- set size_class = 'fa-lg' if size == 'lg' else 'fa-sm' if size == 'sm' else '' -%}
{%- set icons = {
    0: 'fa-face-grin-beam',
    1: 'fa-face-smile-beam',
    2: 'fa-face-meh',
    3: 'fa-face-frown-slight',
    4: 'fa-face-worried',
    5: 'fa-face-frown-open',
    6: 'fa-face-grimace',
    7: 'fa-face-sad-cry',
    8: 'fa-face-confounded',
    9: 'fa-face-weary',
    10: 'fa-face-dizzy'
} -%}
<i class="fa-solid {{ icons.get(level, 'fa-face-meh') }} {{ size_class }} pain-icon--level-{{ level }}" title="Level {{ level }}"></i>
{%- else -%}
<span class="text-muted">-</span>
{%- endif -%}
{% endmacro %}

{# Activity description with configurable display mode
   Modes:
   - 'full' (default): Full text, no truncation
   - 'truncated': Truncated to truncate_at characters
   - 'styled': Full text with styled box (mobile summary)

   Usage:
   {{ activity_description(activity.description) }}
   {{ activity_description(activity.description, mode='truncated') }}
   {{ activity_description(activity.description, mode='styled', show_icon=true) }}
#}
{% macro activity_description(description, mode='full', show_icon=false, truncate_at=100) %}
{%- if description -%}
<div class="activity-description activity-description--{{ mode }}">
    {%- if show_icon -%}<i class="bi bi-chat-text activity-description__icon"></i>{%- endif -%}
    {%- if mode == 'truncated' and description|length > truncate_at -%}
        {{ description[:truncate_at] }}...
    {%- else -%}
        {{ description }}
    {%- endif -%}
</div>
{%- endif -%}
{% endmacro %}
